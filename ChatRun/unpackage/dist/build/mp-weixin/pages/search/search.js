(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/search/search"],{5029:function(e,t,i){"use strict";(function(e){i("1a46");n(i("66fd"));var t=n(i("80e7"));function n(e){return e&&e.__esModule?e:{default:e}}wx.__webpack_require_UNI_MP_PLUGIN__=i,e(t.default)}).call(this,i("543d")["createPage"])},5781:function(e,t,i){"use strict";var n=i("f442"),a=i.n(n);a.a},"80e7":function(e,t,i){"use strict";i.r(t);var n=i("a3d1"),a=i("9a02");for(var r in a)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return a[e]}))}(r);i("5781");var u=i("f0c5"),s=Object(u["a"])(a["default"],n["b"],n["c"],!1,null,null,null,!1,n["a"],void 0);t["default"]=s.exports},"9a02":function(e,t,i){"use strict";i.r(t);var n=i("d652"),a=i.n(n);for(var r in n)["default"].indexOf(r)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(r);t["default"]=a.a},a3d1:function(e,t,i){"use strict";i.d(t,"b",(function(){return n})),i.d(t,"c",(function(){return a})),i.d(t,"a",(function(){}));var n=function(){var e=this,t=e.$createElement;e._self._c;e._isMounted||(e.e0=function(t){e.showModify=!1})},a=[]},d652:function(module,exports,__webpack_require__){"use strict";(function(uni){Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _datas=_interopRequireDefault(__webpack_require__("e652")),_myfun=_interopRequireDefault(__webpack_require__("ec9e"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var myFootBar=function(){__webpack_require__.e("components/myFootBar").then(function(){return resolve(__webpack_require__("4079"))}.bind(null,__webpack_require__)).catch(__webpack_require__.oe)},_default={data:function(){return{pageIndex:1,usrArr:[],uid:"",token:"",markname:"小明",myname:"",name:"",showModify:!1,msg:""}},components:{myFootBar:myFootBar},onLoad:function(){this.getStorages()},methods:{search:_myfun.default.debounce((function(e){this.usrArr=[];var t=e.detail.value;t.length>0&&this.searchUser(t)}),200),searchUser:function(e){var t=this;uni.request({url:this.serverUrl+"/search/user",data:{data:e,token:this.token},method:"POST",success:function(i){var n=i.data.status,a=i.data.result;200===n?a=a.map((function(i,n){t.isMyFriend(i,e)})):300===n?uni.navigateTo({url:"/pages/signin/signin?name="+t.myname}):500===n&&uni.showToast({title:"服务器出错了...",icon:"none",duration:1500})}})},isMyFriend:function isMyFriend(item,e){var _this2=this,tip=0,exp=eval("/"+e+"/g");item._id===this.uid?(tip=2,item.tip=tip,item.imgurl=this.serverUrl+"/"+item.imgurl,item.name=item.name.replace(exp,"<span style='color:#4AAAFF'>"+e+"</span>"),item.email=item.email.replace(exp,"<span style='color:#4AAAFF;'>"+e+"</span>"),this.usrArr.push(item)):uni.request({url:this.serverUrl+"/search/isfriend",data:{uid:this.uid,fid:item._id,token:this.token},method:"POST",success:function(t){var i=t.data.status;t.data.result;200===i?(tip=1,item.tip=tip):400===i?(tip=0,item.tip=tip):300===i?uni.navigateTo({url:"/pages/signin/signin?name="+_this2.myname}):500===i&&uni.showToast({title:"服务器出错了...",icon:"none",duration:1500}),item.tip=tip,item.imgurl=_this2.serverUrl+"/"+item.imgurl,item.name=item.name.replace(exp,"<span style='color:#4AAAFF'>"+e+"</span>"),item.email=item.email.replace(exp,"<span style='color:#4AAAFF;'>"+e+"</span>"),_this2.usrArr.push(item)}})},modify:function(e){0===e.tip?(this.showModify=!0,this.msg=this.myname+"请求添加为好友~",this.sendfid=e._id):1===e.tip&&uni.navigateTo({url:"../chatroom/chatroom?id="+e._id+"&name="+e.name+"&img="+e.imgurl+"&type=0"})},addFriendSub:function(e){var t=this;uni.request({url:this.serverUrl+"/friend/apply",data:{uid:this.uid,fid:e,msg:this.msg,token:this.token},method:"POST",success:function(e){var i=e.data.status;e.data.result;200===i?(t.showModify=!1,uni.showToast({title:"好友请求发送成功",icon:"none",duration:1500})):300===i?uni.navigateTo({url:"/pages/signin/signin?name="+t.myname}):500===i&&uni.showToast({title:"服务器出错了...",icon:"none",duration:1500})}})},getStorages:function(){try{var e=uni.getStorageSync("user");e?(this.uid=e.id,this.imgurl=this.serverUrl+"/"+e.imgurl,this.token=e.token,this.myname=e.name):uni.navigateTo({url:"../signin/signin"})}catch(t){}},backOnePage:function(){uni.navigateBack({delta:1})}}};exports.default=_default}).call(this,__webpack_require__("543d")["default"])},f442:function(e,t,i){}},[["5029","common/runtime","common/vendor"]]]);